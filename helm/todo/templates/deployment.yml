apiVersion: apps/v1
kind: Deployment 
metadata:
    name: "todo-app"
spec:
    selector: 
        matchLabels:
            app: "todoapp"
    replicas: 5
    template:
        metadata:
            labels:
                app: "todoapp"
        spec:
            containers:
            - image: {{.Values.image}}
              imagePullPolicy: Always
              name: "todoapp"
              env:
                - name: db_url
                  value: mongodb://{.Values.username}:{.Values.password}@{{ .Values.dbhost }}
              ports:
              - containerPort: 27017
